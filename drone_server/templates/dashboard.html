<!DOCTYPE html>
<html>
<head>
    <title>Donn√©es Drone</title>
    <meta charset="utf-8">
    
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />

    <style>
        #map {
            height: 500px;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
<div class="container mt-5">
    <h1>Donn√©es r√©centes du drone</h1>

    <!-- Carte Leaflet -->
    <div id="map"></div>

    <!-- Tableau des donn√©es -->
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Temps</th>
                <th>Latitude</th>
                <th>Longitude</th>
                <th>Altitude</th>
                <th>Vitesse</th>
                <th>Mode</th>
            </tr>
        </thead>
        <tbody>
            {% for row in data %}
            <tr>
                <td>{{ row[1] }}</td>
                <td>{{ row[2] }}</td>
                <td>{{ row[3] }}</td>
                <td>{{ row[4] }}</td>
                <td>{{ row[5] }}</td>
                <td>{{ row[6] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

<script>
    // Initialisation de la carte centr√©e par d√©faut sur Kinshasa
    var map = L.map('map').setView([-4.3, 15.3], 13);

    // Ajout de la couche OpenStreetMap
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '¬© OpenStreetMap',
        maxZoom: 18
    }).addTo(map);

    // Si des donn√©es sont disponibles, ajouter le marqueur
    {% if data %}
        var lat = {{ data[0][2] }};
        var lon = {{ data[0][3] }};
        var popup = "üìç Drone ici<br>{{ data[0][1] }}";
        var marker = L.marker([lat, lon]).addTo(map).bindPopup(popup).openPopup();
        map.setView([lat, lon], 16);
    {% endif %}
</script>
</body>
</html>
